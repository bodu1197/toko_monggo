# Tokomonggo 프로젝트 진단 리포트

## 1. 개요

현재 프로젝트의 설정 파일, 코드 구조, 데이터베이스 관리 방식을 분석한 결과, 안정성과 유지보수성을 저해할 수 있는 몇 가지 주요 문제점을 발견했습니다. 이 리포트는 발견된 문제점과 개선을 위한 구체적인 제안을 담고 있습니다.

---

## 2. 상세 분석 및 문제점

### 🚨 심각도 높음 (High Severity)

#### **문제점 1: 수동적이고 위험한 데이터베이스 관리**

- **현상:** `URGENT_FIX_DATABASE.md` 및 `COMPLETE_DATABASE_RESET.md` 파일에서 확인되듯이, 데이터베이스 스키마 변경 및 초기화를 Supabase 대시보드에서 수동으로 SQL 쿼리를 복사/붙여넣기하여 처리하고 있습니다.
- **위험성:**
    - **휴먼 에러:** 수동 작업은 실수할 가능성이 매우 높으며, 이로 인해 데이터베이스가 손상되거나 데이터가 유실될 수 있습니다.
    - **버전 관리 부재:** 어떤 스키마 변경이 언제 적용되었는지 추적하기가 거의 불가능합니다.
    - **환경 간 불일치:** 개발, 스테이징, 프로덕션 환경 간의 데이터베이스 스키마가 달라져 예기치 않은 버그를 유발할 수 있습니다.
- **근거:** `00_RESET_AND_RECREATE.sql`, `00_complete_tokomonggo_schema.sql` 등의 파일을 수동으로 실행하도록 가이드하고 있습니다.

> **권장 해결책:** **Supabase CLI**를 도입하여 마이그레이션 기능을 사용하세요.
> 1. `supabase init`으로 프로젝트를 초기화합니다.
> 2. `supabase db diff`로 변경 사항을 마이그레이션 파일로 생성합니다.
> 3. `supabase db push` (개발) 또는 `supabase migration up` (프로덕션) 명령어로 안전하게 스키마를 적용합니다.
> 이렇게 하면 모든 스키마 변경 사항이 코드로 관리되고, 협업이 원활해지며, 배포가 자동화됩니다.

#### **문제점 2: 불안정한 프레임워크 의존성 사용**

- **현상:** `package.json`에 명시된 `next`와 `react` 버전이 각각 `^15.5.4`, `^19.2.0`으로 설정되어 있습니다.
- **위험성:**
    - 현재(2025년 기준) Next.js 15와 React 19는 안정 버전이 아닐 가능성이 높습니다. 이러한 실험적인 버전을 사용하는 것은 예기치 않은 버그, 잦은 변경 사항, 커뮤니티 지원 부족 등의 문제를 야기할 수 있습니다.
    - 프로젝트의 핵심 프레임워크가 불안정하면, 다른 모든 기능의 안정성을 보장할 수 없습니다.
- **근거:** `package.json` 파일의 `dependencies` 섹션.

> **권장 해결책:** Next.js와 React를 현재의 안정적인 LTS(Long-Term Support) 버전으로 다운그레이드하세요. (예: Next.js 14, React 18)
> ```bash
> npm install next@stable react@stable react-dom@stable
> ```

### ⚠️ 심각도 중간 (Medium Severity)


#### **문제점 4: 자동화된 테스트의 부재**

- **현상:** `package.json`에 `test` 관련 스크립트나 의존성(예: Jest, Playwright, Cypress)이 전혀 없습니다. 데이터베이스 관련 문서에서도 수동 테스트만 언급되어 있습니다.
- **위험성:**
    - 새로운 기능을 추가하거나 기존 코드를 리팩토링할 때, 의도치 않은 버그가 발생해도 사전에 감지할 수 없습니다.
    - 배포에 대한 자신감이 떨어지고, 개발 속도가 저하됩니다.
- **근거:** `package.json` 및 `.md` 문서들.

> **권장 해결책:** 테스트 프레임워크(예: **Jest**와 **React Testing Library**)를 도입하여 최소한의 단위 테스트 및 통합 테스트 작성을 시작하세요. 특히 `handle_new_user`와 같이 중요한 비즈니스 로직은 반드시 테스트로 보호해야 합니다.

---

## 3. 요약 및 다음 단계

현재 프로젝트는 기능적으로 동작할 수 있으나, 매우 불안정하고 유지보수가 어려운 상태입니다. 특히 **데이터베이스 관리 방식**은 가장 시급하게 개선해야 할 문제입니다.

**권장되는 다음 단계:**

1.  **[매우 중요]** **Supabase CLI를 도입**하여 데이터베이스 마이그레이션 워크플로우를 구축하세요.
2.  `next`와 `react` 버전을 안정적인 버전으로 **다운그레이드**하세요.
3.  프로젝트에 불필요한 **백업 파일들을 정리**하세요.
4.  **Jest** 등 테스트 프레임워크를 설정하고, 주요 기능에 대한 **테스트 코드를 작성**하기 시작하세요.
5.  `npm run lint` 명령을 실행하여 현재 코드의 잠재적인 오류를 확인하고 수정하세요.
